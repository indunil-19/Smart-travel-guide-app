{"ast":null,"code":"const {\n  Client\n} = require(\"@googlemaps/google-maps-services-js\");\n\nexport const DeletePOI = async (index, index1, travelPlan = [[[], []], []]) => {\n  const client = new Client({});\n  var start_location = {};\n  var end_location = {};\n  var k = 0;\n  var l = 0;\n\n  for (var i = 0; i <= index; i++) {\n    for (var j = 0; j < travelPlan[i].length; j++) {\n      var k = k + 1;\n\n      if (i == index && j == index1) {\n        l = k;\n      }\n    }\n  }\n\n  console.log(index, index1, travelPlan);\n  var travelDays = travelPlan[0].length;\n  var plan = travelPlan[0];\n\n  if (index > 0) {\n    if (index1 > 0) {\n      console.log(\"1\");\n      start_location = plan[index][index1 - 1].geometry.location; // travelPlan[0][index].pop(index1)\n    } else if (index1 == 0) {\n      console.log(\"2\");\n\n      if (plan[index - 1].length == 0) {\n        start_location = {\n          lat: 6.927079,\n          lng: 79.857750\n        };\n      } else {\n        start_location = plan[index - 1][plan[index - 1].length - 1].geometry.location;\n      } // travelPlan[0][index].pop(index1)\n\n    }\n  } else if (index == 0) {\n    if (index1 == 0) {\n      start_location = {\n        lat: 6.927079,\n        lng: 79.857750\n      }; // travelPlan[0][index].pop(index1)\n    } else if (index1 > 0) {\n      console.log(\"4\");\n      start_location = plan[index][index1 - 1].geometry.location; // travelPlan[0][index].pop(index1)\n    }\n  }\n\n  if (index < travelDays - 1) {\n    if (index1 == plan[index].length - 1) {\n      console.log(\"5\");\n      end_location = plan[index + 1][0].geometry.location;\n      travelPlan[0][index].splice(index1, 1);\n    } else if (index1 < plan[index].length - 1) {\n      console.log(\"6\");\n      end_location = plan[index][index1 + 1].geometry.location;\n      travelPlan[0][index].splice(index1, 1);\n    }\n  } else if (index == travelDays - 1) {\n    if (index1 == plan[index].length - 1) {\n      console.log(\"7\");\n      travelPlan[0][index].splice(index1, 1);\n      travelPlan[1].pop(l - 1);\n      return travelPlan;\n    } else if (index1 < plan[index].length - 1) {\n      console.log(\"8\");\n      end_location = plan[index][index1 + 1].geometry.location;\n      travelPlan[0][index].splice(index1, 1);\n    }\n  }\n\n  return client.directions({\n    params: {\n      origin: start_location,\n      destination: end_location,\n      optimizeWaypoints: true,\n      travelMode: 'DRIVING',\n      key: \"AIzaSyChMTwAb_hWwYdvcM_gSGcx84k_al-EtIA\"\n    }\n  }).then(response => {\n    const route = response.data.routes[0];\n    travelPlan[1].pop(l - 1);\n    travelPlan[1][l - 1] = route.legs[0];\n    return travelPlan;\n  }).catch(e => {\n    console.log(e);\n  });\n};\n_c = DeletePOI;\nexport const DeleteDay = async (day, travelPlan) => {\n  console.log(day);\n  const client = new Client({});\n  var start_location = {};\n  var end_location = {};\n  var remove_count = 0;\n  var pivot = 0;\n\n  for (let i = 0; i < day - 1; i++) {\n    pivot = pivot + travelPlan[0][i].length;\n  }\n\n  var travelDays = travelPlan[0].length;\n\n  if (day == travelDays) {\n    remove_count = travelPlan[0][day - 1].length;\n    travelPlan[0].splice(day - 1, 1);\n    travelPlan[1].splice(pivot, remove_count);\n    return travelPlan;\n  }\n\n  if (day < travelDays) {\n    travelPlan[0].splice(day - 1, 1);\n    start_location = travelPlan[0][day - 2][travelPlan[0][day - 2].length - 1].geometry.location;\n    console.log(travelPlan[0][day]);\n\n    if (travelPlan[0][day]) {\n      travelPlan[0].splice(day - 1, 1);\n      travelPlan[1].splice(pivot, remove_count);\n      return travelPlan;\n    }\n\n    end_location = travelPlan[0][day][0].geometry.location;\n    remove_count = travelPlan[0][day - 1].length;\n    travelPlan[0].splice(day - 1, 1);\n    travelPlan[1].splice(pivot, remove_count);\n  }\n\n  return client.directions({\n    params: {\n      origin: start_location,\n      destination: end_location,\n      optimizeWaypoints: true,\n      travelMode: 'DRIVING',\n      key: \"AIzaSyChMTwAb_hWwYdvcM_gSGcx84k_al-EtIA\"\n    }\n  }).then(response => {\n    const route = response.data.routes[0];\n    travelPlan[1][pivot] = route.legs[0];\n    return travelPlan;\n  }).catch(e => {\n    console.log(e);\n  });\n  return;\n};\n_c2 = DeleteDay;\nexport const findPois = async (day, travelPlan, allpois) => {\n  const client = new Client({}); // console.log(allpois)\n\n  const allpoisDays = travelPlan[0].length;\n  const num_pois_in_day = travelPlan[0][day - 1].length;\n  var start_location = {};\n  var end_location = {};\n\n  if (num_pois_in_day == 0) {\n    if (day == 1) {\n      start_location = {\n        lat: 6.927079,\n        lng: 79.857750\n      };\n    } else {\n      start_location = travelPlan[0][day - 2][travelPlan[0][day - 2].length - 1].geometry.location;\n    }\n  } else {\n    start_location = travelPlan[0][day - 1][num_pois_in_day - 1].geometry.location;\n  }\n\n  var l = 0;\n\n  for (let i = 0; i < day - 1; i++) {\n    l += travelPlan[0][i].length;\n  }\n\n  console.log(travelPlan[1]);\n  var remaining_time = 32400;\n\n  for (let i = 0; i < travelPlan[0][day - 1].length; i++) {\n    remaining_time -= travelPlan[1][l + i].duration.value + 3600;\n  }\n\n  remaining_time -= 3600;\n  console.log(remaining_time);\n  var poisRoute = new Array();\n  var pois = new Array();\n  var poisRouteSuitable = new Array();\n\n  for (var i = 0; i < allpois.length; i++) {\n    const waypts = [];\n\n    if (day < allpoisDays) {\n      end_location = travelPlan[0][day][0].geometry.location;\n      waypts.push(allpois[i].geometry.location);\n    } else {\n      end_location = allpois[i].geometry.location;\n    }\n\n    client.directions({\n      params: {\n        origin: start_location,\n        destination: end_location,\n        optimizeWaypoints: true,\n        travelMode: 'DRIVING',\n        waypoints: waypts,\n        key: \"AIzaSyChMTwAb_hWwYdvcM_gSGcx84k_al-EtIA\"\n      }\n    }).then(response => {\n      const route = response.data.routes[0];\n      const poisLegs = [];\n\n      for (let i = 0; i < route.legs.length; i++) {\n        poisLegs.push(route.legs[i]);\n      } // console.log(poisLegs)  \n\n\n      poisRoute.push(poisLegs);\n    }).catch(e => {\n      console.log(e);\n    });\n  }\n\n  await new Promise(r => setTimeout(r, 6000));\n\n  for (let i = 0; i < poisRoute.length; i++) {\n    if (Array.isArray(poisRoute[i])) {\n      var t = 3600;\n\n      for (let j = 0; j < poisRoute[i].length; j++) {\n        t += poisRoute[i][j].duration.value;\n      }\n\n      if (t <= remaining_time) {\n        pois.push(allpois[i]);\n        poisRouteSuitable.push(poisRoute[i]);\n      }\n    } else {\n      if (poisRoute[i].duration.value <= remaining_time) {\n        pois.push(allpois[i]);\n        poisRouteSuitable.push(poisRoute[i]);\n      }\n    }\n  }\n\n  return [pois, poisRouteSuitable]; // return allpois\n};\nexport const addPoiToPlan = async (day, poi, route, travelPlan) => {\n  var pivot = 0;\n\n  for (let i = 0; i < day - 1; i++) {\n    pivot += travelPlan[0][i].length;\n  }\n\n  travelPlan[0][day - 1].push(poi);\n\n  if (Array.isArray(route)) {\n    if (route.length == 1) {\n      travelPlan[1].splice(pivot + 1, 0, route[0]);\n    } else {\n      travelPlan[1].splice(pivot + 1, 1);\n      travelPlan[1].splice(pivot + 1, 0, route[0], route[1]);\n    }\n  } // else{\n  //   travelPlan[1].splice(pivot+1, 0, route)\n  // }\n\n\n  return travelPlan;\n};\nexport const AddDay = async travelPlan => {\n  travelPlan[0].push([]);\n  return travelPlan;\n};\n_c3 = AddDay;\nexport const switchPOI = async (index, index1, travelPlan = [[[], []], []], allpois) => {\n  const client = new Client({});\n  var start_location = {};\n  var end_location = {};\n  var travelDays = travelPlan[0].length;\n  var plan = travelPlan[0];\n\n  if (index > 0) {\n    if (index1 > 0) {\n      console.log(\"1\");\n      start_location = plan[index][index1 - 1].geometry.location; // travelPlan[0][index].pop(index1)\n    } else if (index1 == 0) {\n      console.log(\"2\");\n\n      if (plan[index - 1].length == 0) {\n        start_location = {\n          lat: 6.927079,\n          lng: 79.857750\n        };\n      } else {\n        start_location = plan[index - 1][plan[index - 1].length - 1].geometry.location;\n      } // travelPlan[0][index].pop(index1)\n\n    }\n  } else if (index == 0) {\n    if (index1 == 0) {\n      start_location = {\n        lat: 6.927079,\n        lng: 79.857750\n      }; // travelPlan[0][index].pop(index1)\n    } else if (index1 > 0) {\n      console.log(\"4\");\n      start_location = plan[index][index1 - 1].geometry.location; // travelPlan[0][index].pop(index1)\n    }\n  }\n\n  if (index < travelDays - 1) {\n    if (index1 == plan[index].length - 1) {\n      console.log(\"5\");\n      end_location = plan[index + 1][0].geometry.location; // travelPlan[0][index].splice(index1,1)\n    } else if (index1 < plan[index].length - 1) {\n      console.log(\"6\");\n      console.log(plan[index]);\n      console.log(index1);\n      end_location = plan[index][index1 + 1].geometry.location; // travelPlan[0][index].splice(index1,1)\n    }\n  } else if (index == travelDays - 1) {\n    if (index1 == plan[index].length - 1) {\n      console.log(\"7\"); // travelPlan[0][index].splice(index1,1)\n      // travelPlan[1].pop(l-1)\n\n      return findPois(index + 1, travelPlan, allpois);\n    } else if (index1 < plan[index].length - 1) {\n      console.log(\"8\");\n      end_location = plan[index][index1 + 1].geometry.location; // travelPlan[0][index].splice(index1,1)\n    }\n  }\n\n  var remaining_time = 32400;\n  var pivot = 0;\n\n  for (let i = 0; i < index; i++) {\n    pivot += travelPlan[0][i].length;\n  }\n\n  for (let i = 0; i < travelPlan[0][index].length; i++) {\n    if (index1 != i) remaining_time -= travelPlan[1][pivot + i].duration.value + 3600;\n  }\n\n  remaining_time -= 3600; // console.log(remaining_time)\n\n  var poisRoute = new Array();\n  var pois = new Array();\n  var poisRouteSuitable = new Array();\n\n  for (var i = 0; i < allpois.length; i++) {\n    const waypts = [allpois[i].geometry.location];\n    client.directions({\n      params: {\n        origin: start_location,\n        destination: end_location,\n        optimizeWaypoints: true,\n        travelMode: 'DRIVING',\n        waypoints: waypts,\n        key: \"AIzaSyChMTwAb_hWwYdvcM_gSGcx84k_al-EtIA\"\n      }\n    }).then(response => {\n      const route = response.data.routes[0]; // console.log(route)\n\n      const poisLegs = [];\n\n      for (let i = 0; i < route.legs.length; i++) {\n        poisLegs.push(route.legs[i]);\n      } // console.log(poisLegs)  \n\n\n      poisRoute.push(poisLegs);\n    }).catch(e => {\n      console.log(e);\n    });\n  }\n\n  await new Promise(r => setTimeout(r, 6000));\n\n  for (let i = 0; i < poisRoute.length; i++) {\n    if (Array.isArray(poisRoute[i])) {\n      var t = 3600;\n\n      for (let j = 0; j < poisRoute[i].length; j++) {\n        t += poisRoute[i][j].duration.value;\n      }\n\n      if (t <= remaining_time) {\n        pois.push(allpois[i]);\n        poisRouteSuitable.push(poisRoute[i]);\n      }\n    } else {\n      if (poisRoute[i].duration.value <= remaining_time) {\n        pois.push(allpois[i]);\n        poisRouteSuitable.push(poisRoute[i]);\n      }\n    }\n  }\n\n  console.log(pois, poisRouteSuitable);\n  return [pois, poisRouteSuitable];\n};\nexport const addPoiToPlan1 = async (index, index1, poi, route, travelPlan) => {\n  var k = 0;\n  var l = 0;\n\n  for (var i = 0; i <= index; i++) {\n    for (var j = 0; j < travelPlan[i].length; j++) {\n      var k = k + 1;\n\n      if (i == index && j == index1) {\n        l = k;\n      }\n    }\n  }\n\n  travelPlan[0][index][index1] = poi;\n\n  if (Array.isArray(route)) {\n    if (route.length == 1) {\n      travelPlan[1].splice(l, 1);\n      travelPlan[1].splice(l, 0, route[0]);\n    } else {\n      travelPlan[1].splice(l, 1);\n      travelPlan[1].splice(l, 1);\n      travelPlan[1].splice(l, 0, route[0], route[1]);\n    }\n  } // else{\n  //   travelPlan[1].splice(pivot+1, 0, route)\n  // }\n\n\n  return travelPlan;\n};\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"DeletePOI\");\n$RefreshReg$(_c2, \"DeleteDay\");\n$RefreshReg$(_c3, \"AddDay\");","map":{"version":3,"sources":["D:/sem 5 project travel guide app/Smart-travel-guide-app/webapp/src/services/EditPlanServices.js"],"names":["Client","require","DeletePOI","index","index1","travelPlan","client","start_location","end_location","k","l","i","j","length","console","log","travelDays","plan","geometry","location","lat","lng","splice","pop","directions","params","origin","destination","optimizeWaypoints","travelMode","key","then","response","route","data","routes","legs","catch","e","DeleteDay","day","remove_count","pivot","findPois","allpois","allpoisDays","num_pois_in_day","remaining_time","duration","value","poisRoute","Array","pois","poisRouteSuitable","waypts","push","waypoints","poisLegs","Promise","r","setTimeout","isArray","t","addPoiToPlan","poi","AddDay","switchPOI","addPoiToPlan1"],"mappings":"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","sourcesContent":["const {Client} = require(\"@googlemaps/google-maps-services-js\");\r\n\r\n   \r\nexport const DeletePOI=async(index, index1, travelPlan=[[[],[]] ,[]])=>{\r\n    const client = new Client({});\r\n    var start_location={}\r\n    var end_location={}\r\n    var k=0\r\n    var l=0\r\n    for(var i=0; i<=index;i++){\r\n      for (var j=0; j<travelPlan[i].length;j++){\r\n        var k=k+1\r\n        if(i==index && j==index1){\r\n            l=k\r\n        }\r\n      }\r\n    } \r\n    \r\n    console.log(index,index1,travelPlan)\r\n    var travelDays=travelPlan[0].length\r\n    var plan=travelPlan[0]\r\n\r\n    if(index>0){\r\n      if(index1>0){\r\n        console.log(\"1\")\r\n        start_location=plan[index][index1-1].geometry.location\r\n        // travelPlan[0][index].pop(index1)\r\n      }\r\n      else if(index1==0){\r\n        console.log(\"2\")\r\n        if(plan[index-1].length==0){\r\n          start_location={lat:6.927079,lng:79.857750}\r\n        }\r\n        else{\r\n          start_location=plan[index-1][plan[index-1].length-1].geometry.location\r\n        }\r\n        \r\n        // travelPlan[0][index].pop(index1)\r\n      }\r\n      \r\n    }\r\n    else if(index==0){\r\n      if(index1==0){\r\n        start_location={lat:6.927079,lng:79.857750}\r\n        // travelPlan[0][index].pop(index1)\r\n\r\n      }\r\n      else if(index1>0){\r\n        console.log(\"4\")\r\n        start_location=plan[index][index1-1].geometry.location\r\n        // travelPlan[0][index].pop(index1)\r\n      }\r\n      \r\n    }\r\n\r\n\r\n    if(index<travelDays-1){\r\n      if(index1==plan[index].length-1){\r\n        console.log(\"5\")\r\n        end_location=plan[index+1][0].geometry.location\r\n        travelPlan[0][index].splice(index1,1)\r\n        \r\n      }\r\n      else if(index1<plan[index].length-1){\r\n        console.log(\"6\")\r\n        end_location=plan[index][index1+1].geometry.location\r\n        travelPlan[0][index].splice(index1,1)\r\n        \r\n      }\r\n    }\r\n    else if(index==travelDays-1){\r\n       if(index1==plan[index].length-1){\r\n\r\n        console.log(\"7\")\r\n        travelPlan[0][index].splice(index1,1)\r\n          travelPlan[1].pop(l-1)\r\n          return travelPlan\r\n       }\r\n       else if (index1<plan[index].length-1){\r\n         console.log(\"8\")\r\n          end_location=plan[index][index1+1].geometry.location\r\n          travelPlan[0][index].splice(index1,1)\r\n        \r\n       }\r\n    }\r\n    \r\n\r\n    return client\r\n      .directions({params:{\r\n          origin:start_location,\r\n          destination:end_location,\r\n          optimizeWaypoints: true,\r\n          travelMode: 'DRIVING',\r\n          key: \"AIzaSyChMTwAb_hWwYdvcM_gSGcx84k_al-EtIA\",\r\n\r\n        }})\r\n        .then((response) => {\r\n          const route = response.data.routes[0];\r\n          travelPlan[1].pop(l-1)\r\n          travelPlan[1][l-1]=route.legs[0]\r\n         \r\n          return travelPlan\r\n         \r\n\r\n        })\r\n         .catch((e) =>{ \r\n           console.log(e)\r\n        });\r\n}\r\n\r\nexport const DeleteDay=async(day, travelPlan)=>{\r\n  console.log(day)\r\n  const client = new Client({});\r\n  var start_location={}\r\n  var end_location={}\r\n\r\n  var remove_count=0\r\n\r\n  var pivot=0\r\n  for(let i=0;i<day-1;i++){\r\n    pivot=pivot+travelPlan[0][i].length\r\n  }\r\n  \r\n\r\n  var travelDays=travelPlan[0].length\r\n  if(day==travelDays){\r\n    remove_count=travelPlan[0][day-1].length\r\n    travelPlan[0].splice(day-1,1)\r\n    travelPlan[1].splice(pivot,remove_count)\r\n    return travelPlan\r\n  }\r\n\r\n  if(day<travelDays){\r\n    travelPlan[0].splice(day-1,1)\r\n    start_location=travelPlan[0][day-2][travelPlan[0][day-2].length-1].geometry.location\r\n    console.log(travelPlan[0][day])\r\n    if(travelPlan[0][day]){\r\n      travelPlan[0].splice(day-1,1)\r\n      travelPlan[1].splice(pivot,remove_count)\r\n      return travelPlan\r\n    }\r\n    end_location=travelPlan[0][day][0].geometry.location\r\n    remove_count=travelPlan[0][day-1].length\r\n    travelPlan[0].splice(day-1,1)\r\n    travelPlan[1].splice(pivot,remove_count)\r\n  }\r\n  return client\r\n      .directions({params:{\r\n          origin:start_location,\r\n          destination:end_location,\r\n          optimizeWaypoints: true,\r\n          travelMode: 'DRIVING',\r\n          key: \"AIzaSyChMTwAb_hWwYdvcM_gSGcx84k_al-EtIA\",\r\n\r\n        }})\r\n        .then((response) => {\r\n          const route = response.data.routes[0];\r\n\r\n          travelPlan[1][pivot]=route.legs[0]\r\n         \r\n          return travelPlan\r\n         \r\n\r\n        })\r\n         .catch((e) =>{ \r\n           console.log(e)\r\n        });\r\n\r\n\r\n\r\n\r\n  return;\r\n\r\n}\r\n\r\n\r\nexport const findPois=async(day,travelPlan,allpois)=>{\r\n    const client = new Client({});\r\n    // console.log(allpois)\r\n    const allpoisDays=travelPlan[0].length\r\n    const num_pois_in_day=travelPlan[0][day-1].length\r\n    var start_location={}\r\n    var end_location={}\r\n    if(num_pois_in_day==0){\r\n      if(day==1){\r\n        start_location={lat:6.927079,lng:79.857750}\r\n      }\r\n      else{\r\n        start_location=travelPlan[0][day-2][travelPlan[0][day-2].length-1].geometry.location\r\n      }\r\n    }\r\n    else{\r\n       start_location=travelPlan[0][day-1][num_pois_in_day-1].geometry.location\r\n    }\r\n\r\n    \r\n    var l=0\r\n    for (let i=0; i<day-1;i++){\r\n      l+=travelPlan[0][i].length\r\n    }\r\n    console.log(travelPlan[1])\r\n\r\n    var remaining_time=32400\r\n\r\n    for(let i=0; i<travelPlan[0][day-1].length; i++){\r\n          remaining_time-=travelPlan[1][l+i].duration.value+3600\r\n    }\r\n    remaining_time-=3600\r\n    console.log(remaining_time)\r\n\r\n\r\n    var poisRoute=new Array()\r\n    var pois=new Array()\r\n    var poisRouteSuitable=new Array()\r\n    \r\n      for(var i=0; i<allpois.length;i++){\r\n        const waypts = [];\r\n        if(day<allpoisDays){\r\n           end_location=travelPlan[0][day][0].geometry.location\r\n           waypts.push(allpois[i].geometry.location)\r\n        }else{\r\n          end_location=allpois[i].geometry.location\r\n        }\r\n        \r\n      client\r\n      .directions({params:{\r\n          \r\n          origin:start_location,\r\n          destination:end_location,\r\n          optimizeWaypoints: true,\r\n          travelMode: 'DRIVING',\r\n          waypoints:waypts,\r\n          key: \"AIzaSyChMTwAb_hWwYdvcM_gSGcx84k_al-EtIA\",\r\n\r\n        }\r\n      })\r\n        .then((response) => {\r\n          const route = response.data.routes[0];\r\n          const poisLegs=[]\r\n          for (let i = 0; i < route.legs.length; i++) {\r\n            poisLegs.push(route.legs[i])\r\n          }\r\n          // console.log(poisLegs)  \r\n          poisRoute.push(poisLegs)\r\n        })\r\n         .catch((e) =>{ \r\n           console.log(e)\r\n        })   \r\n      }\r\n      await new Promise(r => setTimeout(r, 6000));\r\n      \r\n       for(let i=0; i<poisRoute.length;i++){\r\n        if(Array.isArray(poisRoute[i])){\r\n            var t=3600\r\n            for(let j=0; j<poisRoute[i].length;j++){\r\n                t+=poisRoute[i][j].duration.value\r\n            }\r\n            if(t<=remaining_time){\r\n              pois.push(allpois[i])\r\n              poisRouteSuitable.push(poisRoute[i])\r\n            }\r\n        }\r\n        else{\r\n          if(poisRoute[i].duration.value<=remaining_time){\r\n            pois.push(allpois[i])\r\n            poisRouteSuitable.push(poisRoute[i])\r\n          }\r\n        }\r\n        \r\n    }   \r\n     return [pois,poisRouteSuitable]\r\n    // return allpois\r\n}\r\n\r\n\r\nexport const addPoiToPlan=async(day,poi, route,travelPlan)=>{\r\n  var pivot=0\r\n  for(let i=0;i<day-1;i++){\r\n    pivot+=travelPlan[0][i].length\r\n  }\r\n  travelPlan[0][day-1].push(poi)\r\n  if(Array.isArray(route)){\r\n    if(route.length==1){\r\n      travelPlan[1].splice(pivot+1, 0, route[0])\r\n    }\r\n    else{\r\n      travelPlan[1].splice(pivot+1, 1)\r\n      travelPlan[1].splice(pivot+1, 0, route[0],route[1])\r\n    } \r\n  }\r\n  // else{\r\n  //   travelPlan[1].splice(pivot+1, 0, route)\r\n  // }\r\n  \r\n  return travelPlan\r\n\r\n}\r\n\r\nexport const AddDay=async(travelPlan)=>{\r\n  travelPlan[0].push([])\r\n  return travelPlan\r\n}\r\n\r\n\r\n   \r\nexport const switchPOI=async(index, index1, travelPlan=[[[],[]] ,[]],allpois)=>{\r\n  const client = new Client({});\r\n  var start_location={}\r\n  var end_location={}\r\n  \r\n  \r\n  var travelDays=travelPlan[0].length\r\n  var plan=travelPlan[0]\r\n\r\n  if(index>0){\r\n    if(index1>0){\r\n      console.log(\"1\")\r\n      start_location=plan[index][index1-1].geometry.location\r\n      // travelPlan[0][index].pop(index1)\r\n    }\r\n    else if(index1==0){\r\n      console.log(\"2\")\r\n      if(plan[index-1].length==0){\r\n        start_location={lat:6.927079,lng:79.857750}\r\n      }\r\n      else{\r\n        start_location=plan[index-1][plan[index-1].length-1].geometry.location\r\n      }\r\n      \r\n      // travelPlan[0][index].pop(index1)\r\n    }\r\n    \r\n  }\r\n  else if(index==0){\r\n    if(index1==0){\r\n      start_location={lat:6.927079,lng:79.857750}\r\n      // travelPlan[0][index].pop(index1)\r\n\r\n    }\r\n    else if(index1>0){\r\n      console.log(\"4\")\r\n      start_location=plan[index][index1-1].geometry.location\r\n      // travelPlan[0][index].pop(index1)\r\n    }\r\n    \r\n  }\r\n\r\n\r\n  if(index<travelDays-1){\r\n    if(index1==plan[index].length-1){\r\n      console.log(\"5\")\r\n      end_location=plan[index+1][0].geometry.location\r\n      // travelPlan[0][index].splice(index1,1)\r\n      \r\n    }\r\n    else if(index1<plan[index].length-1){\r\n      console.log(\"6\")\r\n      console.log(plan[index])\r\n      console.log(index1)\r\n      end_location=plan[index][index1+1].geometry.location\r\n      \r\n      // travelPlan[0][index].splice(index1,1)\r\n      \r\n    }\r\n  }\r\n  else if(index==travelDays-1){\r\n     if(index1==plan[index].length-1){\r\n\r\n      console.log(\"7\")\r\n      // travelPlan[0][index].splice(index1,1)\r\n      // travelPlan[1].pop(l-1)\r\n      return findPois(index+1,travelPlan,allpois)\r\n     }\r\n     else if (index1<plan[index].length-1){\r\n       console.log(\"8\")\r\n        end_location=plan[index][index1+1].geometry.location\r\n        // travelPlan[0][index].splice(index1,1)\r\n      \r\n     }\r\n  }\r\n  \r\n\r\n  var remaining_time=32400\r\n\r\n  var pivot=0\r\n  for(let i=0;i<index;i++){\r\n    pivot+=travelPlan[0][i].length\r\n  }\r\n  \r\n  for(let i=0; i<travelPlan[0][index].length; i++){\r\n      if(index1!=i) remaining_time-=travelPlan[1][pivot+i].duration.value+3600\r\n        \r\n  }\r\n  remaining_time-=3600\r\n  // console.log(remaining_time)\r\n\r\n\r\n  var poisRoute=new Array()\r\n  var pois=new Array()\r\n  var poisRouteSuitable=new Array()\r\n    for(var i=0; i<allpois.length;i++){\r\n      const waypts = [allpois[i].geometry.location];\r\n      \r\n      \r\n    client\r\n    .directions({params:{\r\n        \r\n        origin:start_location,\r\n        destination:end_location,\r\n        optimizeWaypoints: true,\r\n        travelMode: 'DRIVING',\r\n        waypoints:waypts,\r\n        key: \"AIzaSyChMTwAb_hWwYdvcM_gSGcx84k_al-EtIA\",\r\n\r\n      }\r\n    })\r\n      .then((response) => {\r\n        const route = response.data.routes[0];\r\n        // console.log(route)\r\n        const poisLegs=[]\r\n        for (let i = 0; i < route.legs.length; i++) {\r\n          poisLegs.push(route.legs[i])\r\n        }\r\n        // console.log(poisLegs)  \r\n        poisRoute.push(poisLegs)\r\n      })\r\n       .catch((e) =>{ \r\n         console.log(e)\r\n      })   \r\n    }\r\n    await new Promise(r => setTimeout(r, 6000));\r\n    \r\n     for(let i=0; i<poisRoute.length;i++){\r\n      if(Array.isArray(poisRoute[i])){\r\n          var t=3600\r\n          for(let j=0; j<poisRoute[i].length;j++){\r\n              t+=poisRoute[i][j].duration.value\r\n          }\r\n          if(t<=remaining_time){\r\n            pois.push(allpois[i])\r\n            poisRouteSuitable.push(poisRoute[i])\r\n          }\r\n      }\r\n      else{\r\n        if(poisRoute[i].duration.value<=remaining_time){\r\n          pois.push(allpois[i])\r\n          poisRouteSuitable.push(poisRoute[i])\r\n        }\r\n      }\r\n      \r\n  } \r\n  console.log(pois,poisRouteSuitable)  \r\n   return [pois,poisRouteSuitable]\r\n}\r\n\r\n\r\n\r\nexport const addPoiToPlan1=async(index,index1,poi, route,travelPlan)=>{\r\n  var k=0\r\n  var l=0\r\n  for(var i=0; i<=index;i++){\r\n    for (var j=0; j<travelPlan[i].length;j++){\r\n      var k=k+1\r\n      if(i==index && j==index1){\r\n          l=k\r\n      }\r\n    }\r\n  } \r\n\r\n \r\n  travelPlan[0][index][index1]=poi;\r\n  if(Array.isArray(route)){\r\n    if(route.length==1){\r\n      travelPlan[1].splice(l, 1)\r\n      travelPlan[1].splice(l, 0, route[0])\r\n    }\r\n    else{\r\n      travelPlan[1].splice(l, 1)\r\n      travelPlan[1].splice(l, 1)\r\n      travelPlan[1].splice(l, 0, route[0],route[1])\r\n    } \r\n  }\r\n  // else{\r\n  //   travelPlan[1].splice(pivot+1, 0, route)\r\n  // }\r\n  \r\n  return travelPlan\r\n\r\n}"]},"metadata":{},"sourceType":"module"}